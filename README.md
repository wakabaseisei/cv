# 業務経歴

### スマートフォン向けゲームアプリ開発プロジェクト(2021年7月)
【プロジェクトの概要】<br>
iOS・Android向けのゲームアプリ開発<br>

①チーム構成・規模
- ディレクター 1人
- プランナー 4人
- デザイナー 5人
- バックエンドエンジニア 2人
- クライアントエンジニア 3人(そのうちの1人がリードエンジニア)

②参画時のプロジェクトの状況
当時、プロジェクト全体では、プロトタイプの作成段階で、エンジニア単位では、アルファ版開発に向けたサーバ基盤の構築の段階に入っていました。

③チーム内の自身の役割
インフラ構築の段階で、バックエンドエンジニアの1人として参画しました。GKEで負荷試験を行う必要があり、そのための以下の作業を担当しました
・負荷試験用のアプリを設計・コーディング・テスト
・負荷シナリオの構築
・ローカル環境で負荷をかける

④仕事の進め方
プロジェクトでは、スクラムをベースとした開発をしており、毎日の朝会と職種ごとの夕会、週一のスプリント振り返り会を行なっていました。
個人としては、直属のバックエンド担当の方に、作業指示をいただき、それをもとに1ヶ月の作業計画を立てました。作業単位ごとに、プルリクを出して、コードをレビュー・問題なければマージしていただきました。

【使用技術】<br>
- 負荷試験用アプリ<br>
言語 C#（ASP.NET Core）<br>
データベース MySQL, Redis<br>
O/Rマッパー EFCore, Dapper<br>
負荷試験ツール JMeter<br>
コンテナ基盤 Docker<br>
テスト NUnit<br>

- 負荷シナリオ作成と試験の実施<br>
JMeter, Nginx(リクエストのばらつき具合をログで確認するため)

【業務内容】
##### 負荷試験用アプリ開発
- ユーザー新規登録/一覧取得/個別取得/編集/削除の機能実装
- ログイン・ログアウト機能実装(Keyにトークン、valueにuserIdを格納。expireを1分に設定)
- TODOの一覧取得/個別取得/編集/閲覧/削除の機能実装

##### 負荷シナリオ作成
- JMeterという負荷検証ツールを使って、負荷シナリオを作成
 - シナリオテスト用(シナリオが正しいかを検証)
 - ループテスト用(ループを増やしても正しく動くかを検証)
 - スレッドテスト用(複数のスレッドで正しく動くかを検証)
 - ロングランテスト用(30分間負荷をかけても正しく動くかを検証)
- 負荷試験の実行
 - レスポンスタイムを集計するシェルスクリプトの作成
 - 実際に負荷をかけて、メモリの使用量が経過と共に上昇していないかを確認
 - APIごとの平均・最大レスポンスタイムを計測

【工夫した点】
- 負荷試験で実際に負荷をかけると、各リクエストのタイミングが揃いすぎてしまう問題が発生しました。リクエストを適切にばらけさせるために、jmeterのクライアントとapiサーバとの間にnginxを挟んで、アクセスログを見ながら、ランプアップ時間などを調整して、負荷試験を、実際のシチュエーションに近づけることができました。
- 負荷試験の結果、どのAPIも最大レスポンス時間が1000msを超えていたので、パフォーマンスを改善するために、MySQLの実行プランを確認して、改善できそうなところを特定して、インデックスを貼りました。その結果、各APIごとの最大レスポンスタイムの改善が見られました。
